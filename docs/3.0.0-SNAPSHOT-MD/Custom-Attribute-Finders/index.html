

<!DOCTYPE html>

<html lang="en-US">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge">

  <link rel="stylesheet" href="/assets/css/just-the-docs-default.css">

  <link rel="stylesheet" href="/assets/css/just-the-docs-head-nav.css" id="jtd-head-nav-stylesheet">

  <style id="jtd-nav-activation">
  

.site-nav > ul.nav-list:first-child > li > a,
.site-nav > ul.nav-list:first-child > li > ul > li > a,
.site-nav > ul.nav-list:first-child > li > ul > li > ul > li:not(:nth-child(1)) > a {
  background-image: none;
}

.site-nav > ul.nav-list:not(:first-child) a,
.site-nav li.external a {
  background-image: none;
}

.site-nav > ul.nav-list:first-child > li:nth-child(1) > ul > li:nth-child(8) > ul > li:nth-child(1) > a {
  font-weight: 600;
  text-decoration: none;
}.site-nav > ul.nav-list:first-child > li:nth-child(1) > button svg,
.site-nav > ul.nav-list:first-child > li:nth-child(1) > ul > li:nth-child(8) > button svg {
  transform: rotate(-90deg);
}.site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(1) > ul.nav-list,
.site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(1) > ul.nav-list > li.nav-list-item:nth-child(8) > ul.nav-list {
  display: block;
}
  </style>

  

  
    <script src="/assets/js/vendor/lunr.min.js"></script>
  

  <script src="/assets/js/just-the-docs.js"></script>

  <meta name="viewport" content="width=device-width, initial-scale=1">

  

  <link rel="icon" href="/assets/sapl_reference_images/favicon.png" type="image/x-icon">



  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Custom Attribute Finders | SAPL</title>
<meta name="generator" content="Jekyll v4.3.3" />
<meta property="og:title" content="Custom Attribute Finders" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="SAPL is a powerful policy language and engine to implement Attribute-based access control (ABAC). It comes with developement tools for testing, authorization servers, authoring tools. Framework integrations are available for Spring, Axon, and Vaadin to provide flexible policy enforcement points (PEPs) in your application." />
<meta property="og:description" content="SAPL is a powerful policy language and engine to implement Attribute-based access control (ABAC). It comes with developement tools for testing, authorization servers, authoring tools. Framework integrations are available for Spring, Axon, and Vaadin to provide flexible policy enforcement points (PEPs) in your application." />
<link rel="canonical" href="https://heutelbeck.github.io/Custom-Attribute-Finders/" />
<meta property="og:url" content="https://heutelbeck.github.io/Custom-Attribute-Finders/" />
<meta property="og:site_name" content="SAPL" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Custom Attribute Finders" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"SAPL is a powerful policy language and engine to implement Attribute-based access control (ABAC). It comes with developement tools for testing, authorization servers, authoring tools. Framework integrations are available for Spring, Axon, and Vaadin to provide flexible policy enforcement points (PEPs) in your application.","headline":"Custom Attribute Finders","url":"https://heutelbeck.github.io/Custom-Attribute-Finders/"}</script>
<!-- End Jekyll SEO tag -->


  <link rel="icon" href="/assets/sapl_reference_images/favicon.png" type="image/png">
<!-- Matomo -->
<script type="text/javascript">
    var _paq = window._paq || [];    
    _paq.push(["disableCookies"]);
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
        var u="//www.ftk.de/statistik/";
        _paq.push(['setTrackerUrl', u+'matomo.php']);
        _paq.push(['setSiteId', '2']);
        var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
        g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
    })();
</script>
<!-- End Matomo Code -->


</head>

<body>
  <a class="skip-to-main" href="#main-content">Skip to main content</a>
  <svg xmlns="http://www.w3.org/2000/svg" class="d-none">
  <symbol id="svg-link" viewBox="0 0 24 24">
  <title>Link</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link">
    <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
  </svg>
</symbol>

  <symbol id="svg-menu" viewBox="0 0 24 24">
  <title>Menu</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu">
    <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line>
  </svg>
</symbol>

  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
  <title>Expand</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right">
    <polyline points="9 18 15 12 9 6"></polyline>
  </svg>
</symbol>

  <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE -->
<symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link">
  <title id="svg-external-link-title">(external link)</title>
  <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line>
</symbol>

  
    <symbol id="svg-doc" viewBox="0 0 24 24">
  <title>Document</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file">
    <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline>
  </svg>
</symbol>

    <symbol id="svg-search" viewBox="0 0 24 24">
  <title>Search</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search">
    <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line>
  </svg>
</symbol>

  
  
    <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md -->
<symbol id="svg-copy" viewBox="0 0 16 16">
  <title>Copy</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16">
    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/>
    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/>
  </svg>
</symbol>
<symbol id="svg-copied" viewBox="0 0 16 16">
  <title>Copied</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16">
    <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/>
    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/>
  </svg>
</symbol>

  
</svg>

  <div class="side-bar">
  <div class="site-header" role="banner">
    <a href="https://sapl.io/" class="site-title lh-tight">
  return to SAPL.io

</a>
    <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false">
      <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg>
    </button>
  </div>

  <nav aria-label="Main" id="site-nav" class="site-nav">
  
  
    <ul class="nav-list"><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in SAPL Reference category" aria-pressed="false">
      <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
    </button><a href="/" class="nav-list-link">SAPL Reference</a><ul class="nav-list"><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Introduction category" aria-pressed="false">
            <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
          </button><a href="/Introduction/" class="nav-list-link">Introduction</a><ul class="nav-list"><li class="nav-list-item">
                <a href="/Authorization-Subscriptions/" class="nav-list-link">Authorization Subscriptions</a>
              </li><li class="nav-list-item">
                <a href="/Structure-of-a-SAPL-Policy/" class="nav-list-link">Structure of a SAPL Policy</a>
              </li><li class="nav-list-item">
                <a href="/Authorization-Decisions/" class="nav-list-link">Authorization Decisions</a>
              </li><li class="nav-list-item">
                <a href="/Accessing-Attributes/" class="nav-list-link">Accessing Attributes</a>
              </li><li class="nav-list-item">
                <a href="/Getting-Started/" class="nav-list-link">Getting Started</a>
              </li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Reference Architecture category" aria-pressed="false">
            <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
          </button><a href="/Reference-Architecture" class="nav-list-link">Reference Architecture</a><ul class="nav-list"><li class="nav-list-item">
                <a href="/pep/" class="nav-list-link">PEP</a>
              </li><li class="nav-list-item">
                <a href="/pdp/" class="nav-list-link">PDP</a>
              </li><li class="nav-list-item">
                <a href="/pap/" class="nav-list-link">PAP</a>
              </li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Publish/Subscribe Protocol category" aria-pressed="false">
            <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
          </button><a href="/Publish-Subscribe-Protocol/" class="nav-list-link">Publish/Subscribe Protocol</a><ul class="nav-list"><li class="nav-list-item">
                <a href="/SAPL-Authorization-Subscription/" class="nav-list-link">SAPL Authorization Subscription</a>
              </li><li class="nav-list-item">
                <a href="/SAPL-Authorization-Decision/" class="nav-list-link">SAPL Authorization Decision</a>
              </li><li class="nav-list-item">
                <a href="/Policy-Evaluation/" class="nav-list-link">Policy Evaluation</a>
              </li><li class="nav-list-item">
                <a href="/Multi-Subscriptions/" class="nav-list-link">Multi Subscriptions</a>
              </li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in PDP APIs category" aria-pressed="false">
            <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
          </button><a href="/PDP-APIs/" class="nav-list-link">PDP APIs</a><ul class="nav-list"><li class="nav-list-item">
                <a href="/HTTP-Server-Sent-Events-API/" class="nav-list-link">HTTP Server-Sent Events API</a>
              </li><li class="nav-list-item">
                <a href="/Java-API/" class="nav-list-link">Java API</a>
              </li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in The SAPL Policy Language category" aria-pressed="false">
            <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
          </button><a href="/The-SAPL-Policy-Language/" class="nav-list-link">The SAPL Policy Language</a><ul class="nav-list"><li class="nav-list-item">
                <a href="/Overview/" class="nav-list-link">Overview</a>
              </li><li class="nav-list-item">
                <a href="/Imports/" class="nav-list-link">Imports</a>
              </li><li class="nav-list-item">
                <a href="/Schemas/" class="nav-list-link">Schemas</a>
              </li><li class="nav-list-item">
                <a href="/SAPL-Policy/" class="nav-list-link">SAPL Policy</a>
              </li><li class="nav-list-item">
                <a href="/SAPL-Policy-Set/" class="nav-list-link">SAPL Policy Set</a>
              </li><li class="nav-list-item">
                <a href="/Language-Elements/" class="nav-list-link">Language Elements</a>
              </li><li class="nav-list-item">
                <a href="/SAPL-Expressions/" class="nav-list-link">SAPL Expressions</a>
              </li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Authorization Subscription Evaluation category" aria-pressed="false">
            <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
          </button><a href="/docs/6_1_AuthorizationSubscriptionEvaluation/" class="nav-list-link">Authorization Subscription Evaluation</a><ul class="nav-list"><li class="nav-list-item">
                <a href="/Policy/" class="nav-list-link">Policy</a>
              </li><li class="nav-list-item">
                <a href="/Policy-Set/" class="nav-list-link">Policy Set</a>
              </li><li class="nav-list-item">
                <a href="/Authorization-Subscription/" class="nav-list-link">Authorization Subscription</a>
              </li><li class="nav-list-item">
                <a href="/Combining-Algorithm/" class="nav-list-link">Combining Algorithm</a>
              </li><li class="nav-list-item">
                <a href="/Transformation/" class="nav-list-link">Transformation</a>
              </li><li class="nav-list-item">
                <a href="/Obligation-Advice/" class="nav-list-link">Obligation / Advice</a>
              </li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Functions category" aria-pressed="false">
            <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
          </button><a href="/Functions/" class="nav-list-link">Functions</a><ul class="nav-list"><li class="nav-list-item">
                <a href="/Custom-Function-Libraries/" class="nav-list-link">Custom Function Libraries</a>
              </li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Attribute Finders category" aria-pressed="false">
            <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
          </button><a href="/Attribute-Finders/" class="nav-list-link">Attribute Finders</a><ul class="nav-list"><li class="nav-list-item">
                <a href="/Custom-Attribute-Finders/" class="nav-list-link">Custom Attribute Finders</a>
              </li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Testing SAPL policies category" aria-pressed="false">
            <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
          </button><a href="/Testing-SAPL-policies/" class="nav-list-link">Testing SAPL policies</a><ul class="nav-list"><li class="nav-list-item">
                <a href="/Usage-scenarios/" class="nav-list-link">Usage scenarios</a>
              </li><li class="nav-list-item">
                <a href="/Embedded-PDP/" class="nav-list-link">Embedded PDP</a>
              </li><li class="nav-list-item">
                <a href="/SAPL-Server/" class="nav-list-link">SAPL Server</a>
              </li><li class="nav-list-item">
                <a href="/Unit-Tests/" class="nav-list-link">Unit-Tests</a>
              </li><li class="nav-list-item">
                <a href="/Policy-Integration-Tests/" class="nav-list-link">Policy-Integration-Tests</a>
              </li><li class="nav-list-item">
                <a href="/Writing-test-cases/" class="nav-list-link">Writing test cases</a>
              </li><li class="nav-list-item">
                <a href="/Code-Coverage-Reports-via-the-SAPL-Maven-Plugin/" class="nav-list-link">Code Coverage Reports via the SAPL Maven Plugin</a>
              </li></ul></li></ul></li></ul>

  <ul class="nav-list"><li class="nav-list-item external">
          <a href="https://github.com/heutelbeck/sapl-policy-engine" class="nav-list-link external"
            
          >
            SAPL on GitHub
            <svg viewBox="0 0 24 24" aria-labelledby="svg-external-link-title"><use xlink:href="#svg-external-link"></use></svg>
          </a>
        </li></ul>
</nav>


  
  
    <br>

  
</div>

  <div class="main" id="top">
    <div id="main-header" class="main-header">
  
    

<div class="search" role="search">
  <div class="search-input-wrap">
    <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search SAPL" aria-label="Search SAPL" autocomplete="off">
    <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label>
  </div>
  <div id="search-results" class="search-results"></div>
</div>

  
  
  
    <nav aria-label="Auxiliary" class="aux-nav">
  <ul class="aux-nav-list">
    
      <li class="aux-nav-list-item">
        <a href="https://github.com/heutelbeck/sapl-policy-engine" class="site-button"
          
        >
          SAPL on GitHub
        </a>
      </li>
    
  </ul>
</nav>

  
</div>

    <div class="main-content-wrap">
      <nav aria-label="Breadcrumb" class="breadcrumb-nav">
  <ol class="breadcrumb-nav-list">
  
    <li class="breadcrumb-nav-list-item"><a href="/">SAPL Reference</a></li>
    <li class="breadcrumb-nav-list-item"><a href="/Attribute-Finders/">Attribute Finders</a></li>
  <li class="breadcrumb-nav-list-item"><span>Custom Attribute Finders</span></li>
  </ol>
</nav>
      <div id="main-content" class="main-content">
        <main>
          
            <h3 id="custom-attribute-finders">
  
  
    <a href="#custom-attribute-finders" class="anchor-heading" aria-labelledby="custom-attribute-finders"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Custom Attribute Finders
  
  
</h3>
    

<p>For a more in-depth look at the process of creating a custom PIP, please refer to the demo project. It provides a walkthrough of the entire process and contains extensive examples: <a href="https://github.com/heutelbeck/sapl-demos/tree/master/sapl-demo-extension">https://github.com/heutelbeck/sapl-demos/tree/master/sapl-demo-extension</a> .</p>

<p><strong>Attribute finders</strong> are functions that potentially take a left-hand argument (i.e., the object of which the attribute is to be determined), a <code class="language-plaintext highlighter-rouge">Map</code> of variables defined in the current evaluation scope, and an optional list of incoming parameter streams.</p>

<p>In SAPL, a Policy Information Point is an instance of a class that supplies a set of such functions. To declare functions and classes to be attributes or PIPs, SAPL uses annotations. Each PIP class must be known to the PDP. The embedded PDP provides an <code class="language-plaintext highlighter-rouge">AnnotationAttributeContext</code>, which takes arbitrary Java objects as PIPs. To be recognized as a PIP, the respective class must be annotated with <code class="language-plaintext highlighter-rouge">@PolicyInformationPoint</code>. The optional annotation attribute <code class="language-plaintext highlighter-rouge">name</code> contains the PIPâ€™s name as it will be available in SAPL policies. If the attribute is missing, the name of the Java class is used. The optional annotation attribute <code class="language-plaintext highlighter-rouge">description</code> contains a string describing the PIP for documentation purposes.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="nd">@PolicyInformationPoint</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"user"</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"This the documentation of the PIP"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleUserPIP</span> <span class="o">{</span>
    <span class="o">...</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></div></code></pre></div></div>

<p>The individual attributes supplied by the PIP are identified by adding the annotation <code class="language-plaintext highlighter-rouge">@Attribute</code>. An optional annotation attribute <code class="language-plaintext highlighter-rouge">name</code> can contain a name for the attribute. The attribute must be a string containing an identifier. By default, the name of the function will be used. The annotation attribute <code class="language-plaintext highlighter-rouge">docs</code> can contain a string describing the attribute.</p>

<p>SAPL allows for attribute name overloading. This means that can be multiple implementations for resolving an attribute with one name. For example, you could implement, an environment attribute (<code class="language-plaintext highlighter-rouge">&lt;some.attribute&gt;</code>), a regular attribute (<code class="language-plaintext highlighter-rouge">"UTC".&lt;some.attribute&gt;</code>), both with parameters (<code class="language-plaintext highlighter-rouge">&lt;some.attribute("UTC")&gt;</code>, <code class="language-plaintext highlighter-rouge">"UTC.&lt;some.attribute(5000)&gt;</code>), and maybe even with a variable number of arguments (<code class="language-plaintext highlighter-rouge">&lt;some.attribute&gt;("a","b","c","d",123,4)</code>).</p>

<p>For an attribute of some other object, this object is called the left-hand parameter of the attribute. When writing a method implementing an attribute that takes a left-hand parameter, this parameter must be the first parameter of the method, and it must be of type <code class="language-plaintext highlighter-rouge">Val</code>:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="cm">/* subject.&lt;user.attribute&gt; */</span>
<span class="nd">@Attribute</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"attribute"</span><span class="o">,</span> <span class="n">docs</span> <span class="o">=</span> <span class="s">"documentation"</span><span class="o">)</span>
<span class="kd">public</span> <span class="nc">Flux</span><span class="o">&lt;</span><span class="nc">Val</span><span class="o">&gt;</span> <span class="nf">attribute</span><span class="o">(</span><span class="nd">@Object</span> <span class="nc">Val</span> <span class="n">leftHandObjectOfTheAttribute</span><span class="o">)</span> <span class="o">{</span>
    <span class="o">...</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></div></code></pre></div></div>

<p>Input parameters of the method may be annotated with type validation annotations (see module <code class="language-plaintext highlighter-rouge">sapl-extension-api</code>, package <code class="language-plaintext highlighter-rouge">io.sapl.api.validation</code>). When present, the policy engine validates the contents of the parameters before calling the method. Therefore, if present, the method does not need to perform additional type validation. The method will only be called if the left-hand parameter is a JSON Object in the example above. While different parameter types can be used to disambiguate overloaded methods in languages like Java, this is not possible in SAPL.</p>

<p>A typical use-case for attribute finder is retrieving attribute data from an external data source. If this is a network service like an API or database, the attribute finder usually must know the network address and credentials to authenticate with the service. Such data should never be hardcoded in the PIP. Also, developers should never store this data in policies. In SAPL, developers should store this information and further configuration data for PIPs in the environment variables. For the SAPL Server LT these variables are stored in the pdp.json configuration file, and for the SAPL Server CE they can be edited via the UI.</p>

<p>To access the environment variables, attribute finder methods can consume a Map&lt;String,JsonNode&gt;. The PDP will inject this map at runtime. The map contains all variables available in the current evaluation scope. This map must be the first parameter of the left-hand parameter, or it must be the first parameter for environment attributes. Note that attempting to overload an attribute name with and without variables as a parameter that accept the same number of other parameters will fail. The engine cannot disambiguate these two attributes at runtime.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="cm">/* subject.&lt;user.attribute&gt; definition would clash with last example if defined at the same time in the same PIP*/</span>
<span class="nd">@Attribute</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"attribute"</span><span class="o">,</span> <span class="n">docs</span> <span class="o">=</span> <span class="s">"documentation"</span><span class="o">)</span>
<span class="kd">public</span> <span class="nc">Flux</span><span class="o">&lt;</span><span class="nc">Val</span><span class="o">&gt;</span> <span class="nf">attribute</span><span class="o">(</span><span class="nd">@Object</span> <span class="nc">Val</span> <span class="n">leftHandObjectOfTheAttribute</span><span class="o">,</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span><span class="nc">JsonNode</span><span class="o">&gt;</span> <span class="n">variables</span><span class="o">)</span> <span class="o">{</span>
    <span class="o">...</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></div></code></pre></div></div>

<p>To define environment attributes, i.e., attributes without left-hand parameters, the method definition explicitly does not define a <code class="language-plaintext highlighter-rouge">Val</code> parameter as its first parameter.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="cm">/* &lt;user.attribute&gt; */</span>
<span class="nd">@Attribute</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"attribute"</span><span class="o">,</span> <span class="n">docs</span> <span class="o">=</span> <span class="s">"documentation"</span><span class="o">)</span>
<span class="kd">public</span> <span class="nc">Flux</span><span class="o">&lt;</span><span class="nc">Val</span><span class="o">&gt;</span> <span class="nf">attribute</span><span class="o">()</span> <span class="o">{</span>
    <span class="o">...</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></div></code></pre></div></div>

<p>Optionally, the environment attribute can consume variables:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="cm">/* &lt;user.attribute&gt; definition would clash with last example if defined at the same time in the same PIP */</span>
<span class="nd">@Attribute</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"attribute"</span><span class="o">,</span> <span class="n">docs</span> <span class="o">=</span> <span class="s">"documentation"</span><span class="o">)</span>
<span class="kd">public</span> <span class="nc">Flux</span><span class="o">&lt;</span><span class="nc">Val</span><span class="o">&gt;</span> <span class="nf">attribute</span><span class="o">(</span><span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span><span class="nc">JsonNode</span><span class="o">&gt;</span> <span class="n">variables</span><span class="o">)</span> <span class="o">{</span>
    <span class="o">...</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></div></code></pre></div></div>

<p>A unique feature of SAPL is the possibility to parameterize attribute finders in polices. E.g., <code class="language-plaintext highlighter-rouge">subject.&lt;employees.qualificationOfType("IT")&gt;</code> could return all qualifications of the subject in the domain of <code class="language-plaintext highlighter-rouge">"IT"</code>. Syntactically, SAPL also allows for the concatenation (<code class="language-plaintext highlighter-rouge">subject.&lt;pip1.attr1&gt;.&lt;pip2.attr2&gt;</code>) and nesting of attribute (<code class="language-plaintext highlighter-rouge">subject.&lt;pip1.attr1(resource.&lt;pip2.attr2&gt;,&lt;pip3.attr3&gt;)&gt;</code>).</p>

<p>Regardless of if the attribute is an environment attribute or not, the parameters in brackets are declared as parameters of the method with the type <code class="language-plaintext highlighter-rouge">Flux&lt;Val&gt;</code>.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="cm">/* subject.&lt;user.attribute("param1",123)&gt; */</span>
<span class="nd">@Attribute</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"attribute"</span><span class="o">,</span> <span class="n">docs</span> <span class="o">=</span> <span class="s">"documentation"</span><span class="o">)</span>
<span class="kd">public</span> <span class="nc">Flux</span><span class="o">&lt;</span><span class="nc">Val</span><span class="o">&gt;</span> <span class="nf">attribute</span><span class="o">(</span><span class="nd">@Object</span> <span class="nc">Val</span> <span class="n">leftHandObjectOfTheAttribute</span><span class="o">,</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span><span class="nc">JsonNode</span><span class="o">&gt;</span> <span class="n">variables</span><span class="o">,</span> <span class="nd">@Text</span> <span class="nc">Flux</span><span class="o">&lt;</span><span class="nc">Val</span><span class="o">&gt;</span> <span class="n">param1</span><span class="o">,</span> <span class="nd">@Number</span> <span class="nc">Flux</span><span class="o">&lt;</span><span class="nc">Val</span><span class="o">&gt;</span> <span class="n">param2</span><span class="o">)</span> <span class="o">{</span>
    <span class="o">...</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></div></code></pre></div></div>

<p>Additionally, using Java variable argument lists, it is possible to declare attributes with a variable number of attributes. If a method wants to use variable arguments, the method must not declare any other parameters besides the optional left-hand or variables parameters. If an attribute is overloaded, an implementation with an exact match of the number of arguments takes precedence over a variable arguments implementation.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="cm">/* subject.&lt;user.attribute("AA","BB","CC")&gt; */</span>
<span class="nd">@Attribute</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"attribute"</span><span class="o">,</span> <span class="n">docs</span> <span class="o">=</span> <span class="s">"documentation"</span><span class="o">)</span>
<span class="kd">public</span> <span class="nc">Flux</span><span class="o">&lt;</span><span class="nc">Val</span><span class="o">&gt;</span> <span class="nf">attribute</span><span class="o">(</span><span class="nd">@Object</span> <span class="nc">Val</span> <span class="n">leftHandObjectOfTheAttribute</span><span class="o">,</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span><span class="nc">JsonNode</span><span class="o">&gt;</span> <span class="n">variables</span><span class="o">,</span> <span class="nd">@Text</span> <span class="nc">Flux</span><span class="o">&lt;</span><span class="nc">Val</span><span class="o">&gt;...</span> <span class="n">params</span><span class="o">)</span> <span class="o">{</span>
    <span class="o">...</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></div></code></pre></div></div>

<p>Alternatively defining the variable arguments can be defined as an array.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="cm">/* &lt;user.attribute("AA","BB","CC")&gt; */</span>
<span class="nd">@Attribute</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"attribute"</span><span class="o">,</span> <span class="n">docs</span> <span class="o">=</span> <span class="s">"documentation"</span><span class="o">)</span>
<span class="kd">public</span> <span class="nc">Flux</span><span class="o">&lt;</span><span class="nc">Val</span><span class="o">&gt;</span> <span class="nf">attribute</span><span class="o">(</span><span class="nd">@Text</span> <span class="nc">Flux</span><span class="o">&lt;</span><span class="nc">Val</span><span class="o">&gt;[]</span> <span class="n">params</span><span class="o">)</span> <span class="o">{</span>
    <span class="o">...</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></div></code></pre></div></div>

<p>The methods must not declare any further arguments.</p>

<p><strong>Note</strong>: Developers must add <code class="language-plaintext highlighter-rouge">-parameters</code> parameter to the compilation to ensure that the automatically generated documentation does contain the names of the parameters used in the methods.</p>


          

          
        </main>
        

  <hr>
  <footer>
    
      <p><a href="#top" id="back-to-top">Back to top</a></p>
    

    <p class="text-small text-grey-dk-100 mb-0">Copyright &copy; 2024 Dominic Heutelbeck. Distributed by an <a href="https://github.com/heutelbeck/sapl-policy-engine/blob/master/LICENSE.md">License.</a></p>

    
      <div class="d-flex mt-2">
        
        
      </div>
    
  </footer>


      </div>
    </div>
    
      

<div class="search-overlay"></div>

    
  </div>

  
    






  <script src="https://cdn.jsdelivr.net/npm/mermaid@9.1.6/dist/mermaid.min.js"></script>


<script>
  var config = {}
;
  mermaid.initialize(config);
  window.mermaid.init(undefined, document.querySelectorAll('.language-mermaid'));
</script>



  
</body>
</html>

